<!DOCTYPE html>
<html lang="ptbr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <link rel="stylesheet" href="../css/style4.css">
    <link rel="stylesheet" href="../css/dashboards.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chewy&display=swap" rel="stylesheet">
</head>

<body onload="validarSessao()">
    <div class="janela">
        <div class="header-left dash-header">
            <img src="../assets/imgs/Logo.png">
            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div><br><br>
            <div class="btn-nav-white">
                <a style="text-decoration: none;" href="cards.html">
                    <h3>HOME</h3>
                </a>
            </div>
            <div class="btn-nav-white">
                <a style="text-decoration: none;" href="receitas.html">
                    <h3>RECEITAS</h3>
                </a>
            </div>
            <div class="btn-nav-white">
                <a style="text-decoration: none;" href="./mural.html">
                    <h3>COMUNIDADE</h3>
                </a>
            </div>
        </div>
    </div>
    <div class="tudo">
        <div class="card">
            <div id="inicio" class="inicio">
                <div class="instrucoes">
                    <h2>QUIZ - CONHECIMENTOS CULINÁRIOS</h2>
                    <p style="color: #fff;">Este é um quiz para que você, perdido na cozinha, tenha um parâmetro do nível em que você se
                        encontra. Quem sabe, de tanto ouvir em casa e na TV, você pode descobrir que já sabe mais (ou
                        menos) do que imagina que sabe...</p>
                    <p style="color: #fff;">O jogo é simples: clique em "iniciar" e escolha a alternativa correta para cada pergunta. No
                        final, você terá acesso à sua pontuação e à sua posição no ranking. Bom divertimento!</p>
                </div>
                <div class="iniciar">
                    <button onclick="iniciar()">INICIAR JOGO</button>
                </div>
            </div>
            <div id="questao1" class="questao">
                <span>Qual folha normalmente é utilizada para temperar feijão?</span>
                <img src="../assets/imgs/temperos.jpg">
                <div class="respostas">
                    <input name="q1" type="radio" id="q1_alt1"> Louro
                    <input name="q1" type="radio" id="q1_alt2"> Manjericão
                    <input name="q1" type="radio" id="q1_alt3"> Sálvia
                    <input name="q1" type="radio" id="q1_alt4"> Alecrim
                </div>
                <button onclick="q1()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao2" class="questao">
                <span>Por quanto tempo um ovo precisa ser fervido para ficar bem cozido?</span>
                <img src="../assets/imgs/ovos.jpg">
                <div class="respostas">
                    <input name="q2" type="radio" id="q2_alt1"> 12 minutos
                    <input name="q2" type="radio" id="q2_alt2"> 5 minutos
                    <input name="q2" type="radio" id="q2_alt3"> 3 minutos
                    <input name="q2" type="radio" id="q2_alt4"> 8 minutos
                </div>
                <button onclick="q2()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao3" class="questao">
                <span>Qual técnica pode ser usada para deixar o bolo mais fofo?</span>
                <div class="respostas">
                    <input name="q3" type="radio" id="q3_alt1"> Não bater a massa sem uma batedeira <br><br>
                    <input name="q3" type="radio" id="q3_alt2"> Acrescentar mais fermento <br><br>
                    <input name="q3" type="radio" id="q3_alt3"> Fazer claras em neve com as claras dos ovos utilizados
                    <br><br>
                    <input name="q3" type="radio" id="q3_alt4"> Não bater a massa por muito tempo <br> <br>
                </div>
                <button onclick="q3()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao4" class="questao">
                <span>Qual tipo de carne não pode em hipótese alguma ser consumida mal passada?</span>
                <img src="../assets/imgs/carnes.jpg">
                <div class="respostas">
                    <input name="q4" type="radio" id="q4_alt1"> Peixe
                    <input name="q4" type="radio" id="q4_alt2"> Bovina
                    <input name="q4" type="radio" id="q4_alt3"> Ovina
                    <input name="q4" type="radio" id="q4_alt4"> Suina
                </div>
                <button onclick="q4()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao5" class="questao">
                <span>Quando dizemos que uma massa está al dente, ela está:</span>
                <img src="../assets/imgs/macarrao.png">
                <div class="respostas">
                    <input name="q5" type="radio" id="q5_alt1"> Cozida demais <br>
                    <input name="q5" type="radio" id="q5_alt2"> Nem muito cozida nem muito crua <br>
                    <input name="q5" type="radio" id="q5_alt3"> Quase crua <br>
                    <input name="q5" type="radio" id="q5_alt4"> Totalmente crua
                </div>
                <button onclick="q5()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao6" class="questao">
                <span>Um banho-maria acontece quando:</span>
                <div class="respostas">
                    <input name="q6" type="radio" id="q6_alt1"> Fritamos o alimento em óleo quente <br><br>
                    <input name="q6" type="radio" id="q6_alt2"> Fervemos o alimento em água quente <br><br>
                    <input name="q6" type="radio" id="q6_alt3"> Refogamos o alimento com um pouco de gordura na panela
                    <br><br>
                    <input name="q6" type="radio" id="q6_alt4"> Preparamos o alimento sob calor indireto (um recipiente
                    em cima da panela com água fervendo, por exemplo)
                </div>
                <button onclick="q6()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao7" class="questao">
                <span>Um bom corte para carne de panela:</span>
                <img src="../assets/imgs/carnePanela.png">
                <div class="respostas">
                    <input name="q7" type="radio" id="q7_alt1"> Acém
                    <input name="q7" type="radio" id="q7_alt2"> Filé Mignon
                    <input name="q7" type="radio" id="q7_alt3"> Picanha
                    <input name="q7" type="radio" id="q7_alt4"> Fígado
                </div>
                <button onclick="q7()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao8" class="questao">
                <span>Proporção de água para cozinhar arroz?</span>
                <div class="respostas">
                    <input name="q8" type="radio" id="q8_alt1"> Uma medida de arroz, uma de água <br><br>
                    <input name="q8" type="radio" id="q8_alt2"> Uma medida de arroz, duas de água <br><br>
                    <input name="q8" type="radio" id="q8_alt3"> Uma medida de arroz, três de água <br><br>
                    <input name="q8" type="radio" id="q8_alt4"> Uma medida de arroz, meia de água
                </div>
                <button onclick="q8()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao9" class="questao">
                <span>Qual destes NÃO é um derivado da mandioca?</span>
                <img src="../assets/imgs/mandioca.jpg">
                <div class="respostas">
                    <input name="q9" type="radio" id="q9_alt1"> Tapioca
                    <input name="q9" type="radio" id="q9_alt2"> Sagu
                    <input name="q9" type="radio" id="q9_alt3"> Maizena
                    <input name="q9" type="radio" id="q9_alt4"> Polvilho doce
                </div>
                <button onclick="q9()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao10" class="questao">
                <span>Como escolher limão no supermercado?</span>
                <div class="respostas">
                    <input name="q10" type="radio" id="q10_alt1"> A casca deve ser dura <br><br>
                    <input name="q10" type="radio" id="q10_alt2"> Ele deve ser do verde mais escuro que você encontrar
                    <br><br>
                    <input name="q10" type="radio" id="q10_alt3"> A casca deve ser porosa <br><br>
                    <input name="q10" type="radio" id="q10_alt4"> A casca deve ser fina e lisa
                </div>
                <button onclick="q10()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao11" class="questao">
                <span>Polenta é feita à base de:</span>
                <img src="../assets/imgs/polenta.jpg">
                <div class="respostas">
                    <input name="q11" type="radio" id="q11_alt1"> Fubá
                    <input name="q11" type="radio" id="q11_alt2"> Farinha de mandioca
                    <input name="q11" type="radio" id="q11_alt3"> Polvilho
                    <input name="q11" type="radio" id="q11_alt4"> Farinha de trigo
                </div>
                <button onclick="q11()">PRÓXIMA QUESTÃO</button>
            </div>

            <div id="questao12" class="questao">
                <span>Qual erva é comumente utilizada para temperar molhos de tomate?</span>
                <img src="../assets/imgs/temperos.jpg">
                <div class="respostas">
                    <input name="q12" type="radio" id="q12_alt1"> Salsinha
                    <input name="q12" type="radio" id="q12_alt2"> Alecrim
                    <input name="q12" type="radio" id="q12_alt3"> Manjericão
                    <input name="q12" type="radio" id="q12_alt4"> Sálvia
                </div>
                <button onclick="cadastrar()">FINALIZAR QUIZ</button>
            </div>

            <div id="finalizar" class="finalizar"></div>
            <div id=ranking class="ranking">
                <div class="ranking2">
                    <span id="exibirUsuario"></span>
                    <span id="exibirRanking"></span>
                </div>
                <button><a href="quiz.html">JOGAR NOVAMENTE</a></button>
            </div>
        </div>
    </div>
</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;


    document.querySelectorAll('.questao').forEach(div => {
        div.style.display = 'none';
    });
    finalizar.style.display = 'none';
    ranking.style.display = 'none';
    var pontuacao = 0;


    function iniciar() {
        questao1.style.display = 'flex';
        inicio.style.display = 'none';
    }

    function q1() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao2.style.display = 'flex';
        if (document.getElementById('q1_alt1').checked) pontuacao++;
    }

    function q2() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao3.style.display = 'flex';
        if (document.getElementById('q2_alt1').checked) pontuacao++;
    }

    function q3() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao4.style.display = 'flex';
        if (document.getElementById('q3_alt3').checked) pontuacao++;
    }

    function q4() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao5.style.display = 'flex';
        if (document.getElementById('q4_alt4').checked) pontuacao += 2;
    }

    function q5() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao6.style.display = 'flex';
        if (document.getElementById('q5_alt2').checked) pontuacao += 2;
    }

    function q6() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao7.style.display = 'flex';
        if (document.getElementById('q6_alt4').checked) pontuacao += 2;
    }

    function q7() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao8.style.display = 'flex';
        if (document.getElementById('q7_alt1').checked) pontuacao += 3;
    }

    function q8() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao9.style.display = 'flex';
        if (document.getElementById('q8_alt2').checked) pontuacao += 3;
    }

    function q9() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao10.style.display = 'flex';
        if (document.getElementById('q9_alt3').checked) pontuacao += 3;
    }

    function q10() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao11.style.display = 'flex';
        if (document.getElementById('q10_alt4').checked) pontuacao += 4;
    }

    function q11() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        questao12.style.display = 'flex';
        if (document.getElementById('q11_alt1').checked) pontuacao += 4;
    }


    function cadastrar() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });
        finalizar.style.display = 'flex';
        if (document.getElementById('q12_alt3').checked) pontuacao += 4;

        finalizar.innerHTML = `<img src="../assets/imgs/finalizar.png"> <br>    <span style="font-size: 30px;">Você fez <span style="color: #FAC420;">${pontuacao}/30</span> pontos!</span><br><br>`;
        if (pontuacao < 10) finalizar.innerHTML += `Você com certeza passaria fome se sua alimentação dependesse apenas de você!  <br><br>`;
        else if (pontuacao < 21) finalizar.innerHTML += `Está no caminho, já consegue fazer os básicos e se virar bem na cozinha. <br><br>`
        else finalizar.innerHTML += `Já é praticamente um masterchef! Tem certeza de que não sabe cozinhar? <br> <br>`;
        finalizar.innerHTML += `<button onclick="verRanking()">VER RANKING</button>`;

        var pontuacaoVar = pontuacao;
        var fkUsuarioVar = sessionStorage.ID_USUARIO;

        fetch("/quiz/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                pontuacaoServer: pontuacaoVar,
                fkUsuarioServer: fkUsuarioVar
            }),
        });
    }

    function verRanking() {
        document.querySelectorAll('.questao').forEach(div => {
            div.style.display = 'none';
        });


        finalizar.style.display = 'none';
        ranking.style.display = 'flex';

        fetch("/ranking/verRanking", {
            method: "GET",
            headers: {
                "Content-Type": 'application\json'
            }
        }).then(function (resposta) {

            console.log("Estou no then do listar")

            if (resposta.ok) {
                console.log("Função verRanking():");

                resposta.json().then(function (resposta) {
                    for (var index = 0; index < resposta.length; index++) {
                        var dados = resposta[index];

                        if (index < 3) {
                            exibirUsuario.innerHTML += `<span style="color: #FAC420;">${dados.Usuário.toUpperCase()} </span><br>`
                            exibirRanking.innerHTML += `<span style="color: #FAC420;">${dados.Pontuação} </span><br>`;
                        } else {
                        exibirUsuario.innerHTML += `${dados.Usuário.toUpperCase()} <br>`
                        exibirRanking.innerHTML += ` ${dados.Pontuação} <br>`;
                        }
                    }
                })
            }
        })
    }

</script>